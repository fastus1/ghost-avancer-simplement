---
phase: 03-advanced-layout
plan: 02
type: execute
wave: 1
depends_on: []
files_modified:
  - content/themes/avancer-simplement/partials/circle-sidebar.hbs
  - content/themes/avancer-simplement/partials/mobile-menu.hbs
  - content/themes/avancer-simplement/assets/css/screen.css
  - content/themes/avancer-simplement/assets/js/mobile-menu.js
autonomous: true

must_haves:
  truths:
    - "Sidebar is 281px wide with #2B2E33 background in dark mode"
    - "Sidebar displays recent articles via Ghost {{#get}} helper"
    - "Theme toggle button appears at bottom of sidebar"
    - "Mobile menu shows full navigation when hamburger is clicked"
    - "Escape key closes mobile menu"
  artifacts:
    - path: "content/themes/avancer-simplement/partials/circle-sidebar.hbs"
      provides: "Sidebar with article list and theme toggle"
      contains: "circle-sidebar"
    - path: "content/themes/avancer-simplement/partials/mobile-menu.hbs"
      provides: "Mobile navigation overlay"
      contains: "mobile-menu"
    - path: "content/themes/avancer-simplement/assets/js/mobile-menu.js"
      provides: "Accessibility enhancements for hamburger menu"
      contains: "mobile-menu-toggle"
  key_links:
    - from: "partials/circle-sidebar.hbs"
      to: "Ghost Content API"
      via: "{{#get 'posts'}}"
      pattern: "\\{\\{#get 'posts'"
    - from: "partials/circle-sidebar.hbs"
      to: "partials/theme-toggle.hbs"
      via: "partial include"
      pattern: "\\{\\{> \"theme-toggle\""
---

<objective>
Create the Circle.so-style sidebar and mobile menu partials

Purpose: Enable article navigation in sidebar and mobile-friendly hamburger menu
Output: Sidebar and mobile menu partials with CSS ready for layout integration
</objective>

<execution_context>
@/root/.claude/get-shit-done/workflows/execute-plan.md
@/root/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/phases/03-advanced-layout/03-CONTEXT.md
@.planning/phases/03-advanced-layout/03-RESEARCH.md
@/root/yan/projets/Ghost Avancer Simplement/design-ghost.md

# Existing theme structure
@content/themes/avancer-simplement/default.hbs
@content/themes/avancer-simplement/assets/css/global.css
@content/themes/avancer-simplement/partials/theme-toggle.hbs
</context>

<tasks>

<task type="auto">
  <name>Task 1: Create sidebar partial with article list</name>
  <files>content/themes/avancer-simplement/partials/circle-sidebar.hbs</files>
  <action>
Create partials/circle-sidebar.hbs with:

1. Sidebar container with class "circle-sidebar"

2. Articles section:
   - Section title "Articles" with class "sidebar-section__title"
   - Use {{#get 'posts' limit='10' order='published_at desc'}} to fetch recent posts
   - Inside get block: nav.sidebar-posts with aria-label="Articles recents"
   - ul.sidebar-posts__list
   - For each post via {{#foreach posts}}:
     - li.sidebar-posts__item
     - a.sidebar-posts__link with href="{{url}}"
     - Display {{title}}
   - Handle empty state with {{else}} showing "Aucun article"

3. Theme toggle at bottom:
   - Wrapper div.sidebar-toggle-wrapper at bottom
   - Include {{> "theme-toggle"}}

Structure:
```handlebars
<aside class="circle-sidebar">
    <section class="sidebar-section">
        <h2 class="sidebar-section__title">Articles</h2>
        {{#get 'posts' limit='10' order='published_at desc'}}
            <nav class="sidebar-posts" aria-label="Articles recents">
                <ul class="sidebar-posts__list">
                    {{#foreach posts}}
                        <li class="sidebar-posts__item">
                            <a href="{{url}}" class="sidebar-posts__link">{{title}}</a>
                        </li>
                    {{/foreach}}
                </ul>
            </nav>
        {{else}}
            <p class="sidebar-empty">Aucun article</p>
        {{/get}}
    </section>

    <div class="sidebar-toggle-wrapper">
        {{> "theme-toggle"}}
    </div>
</aside>
```
  </action>
  <verify>
- grep "{{#get 'posts'" partials/circle-sidebar.hbs
- grep "theme-toggle" partials/circle-sidebar.hbs
  </verify>
  <done>Sidebar partial with article list and theme toggle</done>
</task>

<task type="auto">
  <name>Task 2: Create mobile menu partial and JavaScript</name>
  <files>
content/themes/avancer-simplement/partials/mobile-menu.hbs
content/themes/avancer-simplement/assets/js/mobile-menu.js
  </files>
  <action>
Create partials/mobile-menu.hbs:

1. Hidden checkbox for CSS-only fallback:
   - input type="checkbox" id="mobile-menu-toggle" class="mobile-menu__checkbox" aria-hidden="true"

2. Mobile menu overlay div.mobile-menu:
   - role="navigation" aria-label="Menu mobile"
   - nav.mobile-menu__nav inside
   - Duplicate Circle.so navigation links (same as header):
     - Accueil, Nos Applications, Cours, Blog, Evenements, Membres, Leaderboard
   - Same URLs and attributes as header (external links with target="_blank" rel="noopener")

Create assets/js/mobile-menu.js:

Accessibility enhancements (as per research):
1. On DOMContentLoaded:
   - Get checkbox, burger label, and menu elements
   - Add ARIA attributes to burger (role="button", aria-expanded="false", aria-controls="mobile-menu")
   - Set menu id="mobile-menu"

2. On checkbox change:
   - Update aria-expanded on burger
   - If open, focus first link in menu

3. On Escape key:
   - If checkbox checked, uncheck it
   - Update aria-expanded to false
   - Return focus to burger

Use IIFE pattern for scope isolation.
  </action>
  <verify>
- ls partials/mobile-menu.hbs
- grep "mobile-menu-toggle" partials/mobile-menu.hbs
- grep "aria-expanded" assets/js/mobile-menu.js
  </verify>
  <done>Mobile menu partial and JS with accessibility enhancements</done>
</task>

<task type="auto">
  <name>Task 3: Add sidebar and mobile menu CSS</name>
  <files>content/themes/avancer-simplement/assets/css/screen.css</files>
  <action>
Add section "15. Circle Sidebar" after section 14 (Circle Header) in screen.css:

Sidebar container:
- .circle-sidebar: width 281px, background var(--color-sidebar-bg), border-right 1px solid var(--color-border), padding 16px 0, display flex, flex-direction column

Section styling:
- .sidebar-section: padding 0 8px
- .sidebar-section__title: padding 6px 16px, font-size 14px, font-weight 600, color var(--color-sidebar-text)

Posts list:
- .sidebar-posts__list: list-style none, margin 0, padding 0
- .sidebar-posts__item: margin 0
- .sidebar-posts__link: display block, padding 7px 16px, min-height 35px, font-size 16px, font-weight 400, color var(--color-sidebar-text), text-decoration none, border-radius 12px, transition background-color 0.2s ease
- .sidebar-posts__link:hover, .sidebar-posts__link:focus: background var(--color-sidebar-hover)

Toggle wrapper at bottom:
- .sidebar-toggle-wrapper: margin-top auto, padding 16px, border-top 1px solid var(--color-border)

Add section "16. Mobile Menu" after sidebar section:

Checkbox hack:
- .mobile-menu__checkbox: position absolute, left -9999px (visually hidden but accessible)

Mobile menu overlay:
- .mobile-menu: position fixed, top 64px, left 0, right 0, bottom 0, background var(--color-sidebar-bg), transform translateX(-100%), transition transform 0.3s ease, visibility hidden, z-index 90, padding 16px
- .mobile-menu__checkbox:checked ~ .mobile-menu: transform translateX(0), visibility visible

Mobile nav links (similar to sidebar):
- .mobile-menu__nav ul: list-style none, margin 0, padding 0
- .mobile-menu__link: display block, padding 12px 16px, font-size 16px, color var(--color-sidebar-text), text-decoration none, border-radius 8px
- .mobile-menu__link:hover: background var(--color-sidebar-hover)

Hamburger animation (transforms when checked):
- .mobile-menu__checkbox:checked ~ .site-wrapper .circle-header .burger-line:nth-child(1): transform translateY(8px) rotate(45deg)
- .mobile-menu__checkbox:checked ~ .site-wrapper .circle-header .burger-line:nth-child(2): opacity 0
- .mobile-menu__checkbox:checked ~ .site-wrapper .circle-header .burger-line:nth-child(3): transform translateY(-8px) rotate(-45deg)

Note: .site-wrapper class will be added in Plan 03. For now, use .viewport as parent.
  </action>
  <verify>
- grep ".circle-sidebar {" assets/css/screen.css
- grep ".mobile-menu {" assets/css/screen.css
  </verify>
  <done>Sidebar and mobile menu CSS with checkbox hack animation</done>
</task>

</tasks>

<verification>
1. File partials/circle-sidebar.hbs exists with {{#get 'posts'}} and theme-toggle include
2. File partials/mobile-menu.hbs exists with checkbox and navigation links
3. File assets/js/mobile-menu.js exists with ARIA enhancements
4. screen.css contains sections 15 and 16 for sidebar and mobile menu
5. Theme builds without errors (npm run zip)
</verification>

<success_criteria>
- Sidebar partial fetches and displays recent articles
- Theme toggle relocated to sidebar bottom
- Mobile menu uses CSS checkbox hack with JS accessibility layer
- All CSS uses variables for dark/light mode support
- Theme passes gscan validation
</success_criteria>

<output>
After completion, create `.planning/phases/03-advanced-layout/03-02-SUMMARY.md`
</output>
