---
phase: 02-theme-branding
plan: 02
type: execute
wave: 2
depends_on: ["02-01"]
files_modified:
  - content/themes/avancer-simplement/assets/css/global.css
  - content/themes/avancer-simplement/assets/css/screen.css
autonomous: true

must_haves:
  truths:
    - "Light mode uses brand color #074491"
    - "Dark mode uses brand color #3085F5"
    - "Inter font is applied to all text"
    - "CSS compiles without errors via gulp"
  artifacts:
    - path: "content/themes/avancer-simplement/assets/css/global.css"
      provides: "CSS custom properties for light and dark modes"
      contains: "--color-brand"
    - path: "content/themes/avancer-simplement/assets/css/screen.css"
      provides: "Main stylesheet with fonts.css import"
      contains: "@import"
  key_links:
    - from: "screen.css"
      to: "fonts.css"
      via: "@import statement"
      pattern: "@import.*fonts\\.css"
    - from: "global.css"
      to: "branding colors"
      via: "CSS custom properties"
      pattern: "#074491|#3085F5"
---

<objective>
Implement CSS custom properties for theming with light and dark mode color schemes matching Circle.so branding.

Purpose: Establish the visual foundation for the blog with brand colors that switch seamlessly between modes.
Output: Complete CSS variable system with Inter font and brand colors for both light and dark modes.
</objective>

<execution_context>
@/root/.claude/get-shit-done/workflows/execute-plan.md
@/root/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/phases/02-theme-branding/02-RESEARCH.md
@branding-avancer-simplement.md
@.planning/phases/02-theme-branding/02-01-SUMMARY.md
</context>

<tasks>

<task type="auto">
  <name>Task 1: Create CSS custom properties in global.css</name>
  <files>
    content/themes/avancer-simplement/assets/css/global.css
  </files>
  <action>
Edit assets/css/global.css to add/update CSS custom properties. The file exists in Casper - we're overriding/extending it.

Add at the TOP of the file (before existing :root):

```css
/* ============================================
   Avancer Simplement Brand Variables
   ============================================ */

:root {
    /* Typography - Inter font */
    --font-primary: Inter, -apple-system, BlinkMacSystemFont, "Segoe UI", sans-serif;
    --font-serif: Georgia, Times, serif;
    --font-mono: Menlo, Courier, monospace;

    /* Typography sizes (from branding doc) */
    --text-xs: 12px;
    --text-sm: 14px;
    --text-base: 16px;
    --text-lg: 18px;
    --text-xl: 20px;
    --text-2xl: 24px;
    --text-3xl: 28px;
    --text-4xl: 32px;
    --text-5xl: 40px;

    /* Font weights */
    --font-normal: 400;
    --font-medium: 500;
    --font-semibold: 600;
    --font-bold: 700;

    /* Line heights */
    --leading-tight: 1.2;
    --leading-snug: 1.3;
    --leading-normal: 1.5;
    --leading-relaxed: 1.6;

    /* Light mode colors (default) - from branding doc */
    --color-brand: #074491;
    --color-brand-text: #FFFFFF;
    --color-link: #2563EB;
    --color-bg: #FFFFFF;
    --color-text: #000000;
    --color-text-secondary: #545861;
    --color-border: #e1e1e1;
    --color-header-bg: #FFFFFF;
    --color-header-text: #000000;
    --color-header-active-text: #545861;
    --color-header-active-bg: #F0F3F5;
    --color-sidebar-bg: #FFFFFF;
    --color-sidebar-text: #545861;
    --color-sidebar-active: #074491;
    --color-sidebar-active-text: #FFFFFF;
    --color-sidebar-hover: #F0F3F5;

    /* Accent colors */
    --color-orange: #e05a03;
    --color-green: #009a2a;
    --color-yellow: #ffb200;
    --color-red: #db0e00;
    --color-purple: #641892;
    --color-magenta: #a82360;
}

/* Dark mode overrides - triggered by html.dark-mode class */
html.dark-mode {
    --color-brand: #3085F5;
    --color-brand-text: #202226;
    --color-link: #539DFF;
    --color-bg: #2B2E33;
    --color-text: #E4E7EB;
    --color-text-secondary: #E4E7EB;
    --color-border: #42464D;
    --color-header-bg: #2B2E33;
    --color-header-text: #E4E7EB;
    --color-header-active-text: #E4E7EB;
    --color-header-active-bg: #42464D;
    --color-sidebar-bg: #2B2E33;
    --color-sidebar-text: #E4E7EB;
    --color-sidebar-active: #42464D;
    --color-sidebar-active-text: #FFFFFF;
    --color-sidebar-hover: #42464D;
}
```

Then search the existing file for any hardcoded colors that should use variables and update them:
- Replace hardcoded #fff/#ffffff with var(--color-bg)
- Replace hardcoded #000/#000000 with var(--color-text)
- Replace link colors with var(--color-link)
- Replace font-family declarations with var(--font-primary)

AVOID: Removing any existing Casper variables that are still in use.
WHY: Casper templates may reference them; safer to extend than replace.
  </action>
  <verify>
    - `grep '#074491' content/themes/avancer-simplement/assets/css/global.css` returns match
    - `grep '#3085F5' content/themes/avancer-simplement/assets/css/global.css` returns match
    - `grep 'html.dark-mode' content/themes/avancer-simplement/assets/css/global.css` returns match
    - `grep 'Inter' content/themes/avancer-simplement/assets/css/global.css` returns match
  </verify>
  <done>
    CSS custom properties defined for both light and dark modes with all brand colors from Circle.so.
  </done>
</task>

<task type="auto">
  <name>Task 2: Update screen.css to import fonts and apply variables</name>
  <files>
    content/themes/avancer-simplement/assets/css/screen.css
  </files>
  <action>
Edit assets/css/screen.css to:

1. Add fonts.css import at the very top (before any other imports):
```css
/* Avancer Simplement custom fonts */
@import "fonts.css";
```

2. Ensure global.css is imported (should already be there in Casper).

3. Update body styles to use Inter:
```css
body {
    font-family: var(--font-primary);
    background-color: var(--color-bg);
    color: var(--color-text);
    font-feature-settings: 'liga' 1, 'calt' 1; /* Enable Inter ligatures */
}
```

4. Update key elements to use CSS variables:
   - Links: `color: var(--color-link);`
   - Headers (.gh-head): `background: var(--color-header-bg); color: var(--color-header-text);`
   - Article content: `color: var(--color-text);`
   - Borders: `border-color: var(--color-border);`

5. Search for hardcoded hex colors (#fff, #000, #15171A, etc.) and replace with appropriate variables.

6. Build CSS to verify:
```bash
cd content/themes/avancer-simplement && npm run dev
```
(Ctrl+C after it compiles once)

AVOID: Changing structural CSS (margins, padding, layout).
WHY: Focus on colors and typography only; preserve Casper's proven layout.
  </action>
  <verify>
    - `grep '@import.*fonts' content/themes/avancer-simplement/assets/css/screen.css` returns match
    - `grep 'var(--color-' content/themes/avancer-simplement/assets/css/screen.css` returns multiple matches
    - `cd content/themes/avancer-simplement && npm run zip` creates theme zip without errors
  </verify>
  <done>
    screen.css imports fonts.css and uses CSS variables throughout. Theme builds successfully.
  </done>
</task>

<task type="auto">
  <name>Task 3: Build and validate theme</name>
  <files>
    content/themes/avancer-simplement/assets/built/*
  </files>
  <action>
1. Build the theme:
```bash
cd content/themes/avancer-simplement
npm run zip
```

2. Validate with GScan:
```bash
npx gscan .
```

3. Check compiled CSS includes our variables:
```bash
grep -r 'Inter' assets/built/ || echo "Check if built folder exists"
```

4. If errors, fix them before marking complete.

AVOID: Ignoring GScan warnings about deprecated features.
WHY: These may break in future Ghost versions.
  </action>
  <verify>
    - `ls content/themes/avancer-simplement/dist/avancer-simplement.zip` exists (or similar)
    - `cd content/themes/avancer-simplement && npx gscan . 2>&1 | grep -i error` returns nothing
  </verify>
  <done>
    Theme compiles without errors and passes GScan validation.
  </done>
</task>

</tasks>

<verification>
Overall plan verification:
1. CSS custom properties include all brand colors
2. Dark mode class (html.dark-mode) triggers color overrides
3. Inter font is referenced in body styles
4. Theme builds and validates successfully
</verification>

<success_criteria>
- global.css contains :root with light mode colors
- global.css contains html.dark-mode with dark mode colors
- screen.css imports fonts.css
- screen.css uses var(--color-*) for colors
- npm run zip creates valid theme package
- GScan shows no errors
</success_criteria>

<output>
After completion, create `.planning/phases/02-theme-branding/02-02-SUMMARY.md`
</output>
