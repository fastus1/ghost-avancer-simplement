<!DOCTYPE html>
<html lang="{{@site.locale}}"{{#match @custom.color_scheme "Dark"}} class="dark-mode"{{else match @custom.color_scheme "Auto"}} class="auto-color"{{/match}}>
<head>
    {{!-- FOWT Prevention: Apply theme before any content renders --}}
    <script>
        (function() {
            var theme = localStorage.getItem('theme-preference');
            if (theme === 'dark' || (!theme && window.matchMedia('(prefers-color-scheme: dark)').matches)) {
                document.documentElement.classList.add('dark-mode');
            }
        })();
    </script>

    {{!-- Basic meta - advanced meta is output with {ghost_head} below --}}
    <title>{{meta_title}}</title>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="HandheldFriendly" content="True" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />

    {{!-- Preload scripts --}}
    <link rel="preload" as="style" href="{{asset "built/screen.css"}}" />
    <link rel="preload" as="script" href="{{asset "built/casper.js"}}" />

    {{!-- Theme assets - use the {asset} helper to reference styles & scripts,
    this will take care of caching and cache-busting automatically --}}
    <link rel="stylesheet" type="text/css" href="{{asset "built/screen.css"}}" />

    {{!-- This tag outputs all your advanced SEO meta, structured data, and other important settings,
    it should always be the last tag before the closing head tag --}}
    {{ghost_head}}

</head>
<body class="{{body_class}}{{#match @custom.title_font "=" "Elegant serif"}} has-serif-title{{/match}}{{#match @custom.body_font "=" "Modern sans-serif"}} has-sans-body{{/match}}">

{{!-- Mobile menu checkbox must be sibling to .site-layout for CSS checkbox hack --}}
{{> "mobile-menu"}}

<div class="site-layout">
    {{!-- Circle.so Header --}}
    {{> "circle-header"}}

    {{!-- Sidebar with articles --}}
    {{> "circle-sidebar"}}

    {{!-- Main content area --}}
    <main class="site-main">
        {{{body}}}
    </main>
</div>

{{!-- Custom Search Modal --}}
{{> "custom-search"}}

{{!-- Footer outside site-layout --}}
<footer class="site-footer outer">
    <div class="inner">
        <section class="copyright"><a href="{{@site.url}}">{{@site.title}}</a> &copy; {{date format="YYYY"}}</section>
        <nav class="site-footer-nav">
            {{navigation type="secondary"}}
        </nav>
        <div class="gh-powered-by"><a href="https://ghost.org/" target="_blank" rel="noopener">Powered by Ghost</a></div>
    </div>
</footer>

{{#is "post, page"}}
    {{> "lightbox"}}
{{/is}}

{{!-- Scripts - handle member signups, responsive videos, infinite scroll, floating headers, and galleries --}}
<script
    src="https://code.jquery.com/jquery-3.5.1.min.js"
    integrity="sha256-9/aliU8dGd2tb6OSsuzixeV4y/faTqgFtohetphbbj0="
    crossorigin="anonymous">
</script>
<script src="{{asset "built/casper.js"}}"></script>
<script>
$(document).ready(function () {
    // FitVids - Makes video embeds responsive
    $(".gh-content").fitVids();
});
</script>

{{!-- Mobile menu accessibility JS --}}
<script src="{{asset "js/mobile-menu.js"}}"></script>

{{!-- Theme toggle script for dark/light mode --}}
<script src="{{asset "js/theme-toggle.js"}}"></script>

{{!-- Custom search modal --}}
<script src="{{asset "js/custom-search.js"}}"></script>

{{!-- Priority Navigation (responsive menu with "Plus" dropdown) --}}
<script src="{{asset "js/priority-nav.js"}}"></script>

{{!-- Ghost outputs required functional scripts with this tag - it should always be the last thing before the closing body tag --}}
{{ghost_foot}}

</body>
</html>
